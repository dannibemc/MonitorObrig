<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Monitoramento de Crédito</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8fafc;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #343E83 0%, #9E36EF 100%);
        }
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const creditData = [
            { id: "#CR-7845", client: "Empresa ABC Ltda.", cnpj: "12.345.678/0001-90", type: "Imobiliário", value: 1250000, rate: 12.5, status: "Adimplente", progress: 75, startDate: "15/03/2022", endDate: "15/03/2027", paidValue: 937500, remainingValue: 312500, nextPaymentDate: "15/07/2023", installmentValue: 26042, riskScore: 80, documents: [], alerts: [], serasaRating: "AA" },
            { id: "#CR-7844", client: "Construtora XYZ S.A.", cnpj: "98.765.432/0001-12", type: "Corporativo", value: 3750000, rate: 14.2, status: "Em Atraso", progress: 45, startDate: "10/01/2022", endDate: "10/01/2026", paidValue: 1687500, remainingValue: 2062500, nextPaymentDate: "20/07/2023", installmentValue: 62500, riskScore: 60, documents: [], alerts: ["Atraso de pagamento detectado"], serasaRating: "BB" },
            { id: "#CR-7843", client: "Indústrias Silva Ltda.", cnpj: "45.678.901/0001-23", type: "Industrial", value: 2100000, rate: 13.8, status: "Inadimplente", progress: 30, startDate: "01/02/2022", endDate: "01/02/2025", paidValue: 630000, remainingValue: 1470000, nextPaymentDate: "30/07/2023", installmentValue: 43750, riskScore: 40, documents: [], alerts: ["Inadimplência confirmada", "Risco de vencimento antecipado"], serasaRating: "CC" },
            { id: "#CR-7842", client: "Tech Solutions S.A.", cnpj: "67.890.123/0001-34", type: "Tecnologia", value: 850000, rate: 15.5, status: "Adimplente", progress: 90, startDate: "20/04/2022", endDate: "20/04/2024", paidValue: 765000, remainingValue: 85000, nextPaymentDate: "10/07/2023", installmentValue: 21250, riskScore: 90, documents: [], alerts: [], serasaRating: "AAA" },
            { id: "#CR-7841", client: "Agro Forte Ltda.", cnpj: "89.012.345/0001-45", type: "Agronegócio", value: 1750000, rate: 11.9, status: "Adimplente", progress: 60, startDate: "05/05/2022", endDate: "05/05/2028", paidValue: 1050000, remainingValue: 700000, nextPaymentDate: "25/07/2023", installmentValue: 29167, riskScore: 85, documents: [], alerts: [], serasaRating: "AA" },
        ];

        const paymentHistory = {
            "#CR-7845": [
                { date: "15/06/2023", value: 26042, status: "Pago", receipt: "#" },
                { date: "15/05/2023", value: 26042, status: "Pago", receipt: "#" },
                { date: "15/04/2023", value: 26042, status: "Pago", receipt: "#" },
            ],
        };

        const CreditDashboard = () => {
            const [selectedCredit, setSelectedCredit] = useState(null);
            const [statusFilter, setStatusFilter] = useState("Todos os Status");
            const [periodFilter, setPeriodFilter] = useState("Últimos 30 dias");
            const [operationFilter, setOperationFilter] = useState("Todas as Operações");
            const [filteredCredits, setFilteredCredits] = useState(creditData);
            const [currentPage, setCurrentPage] = useState(1);
            const [uploadedDocuments, setUploadedDocuments] = useState({});
            const [dossierNotes, setDossierNotes] = useState("");
            const creditsPerPage = 5;
            const performanceChartRef = useRef(null);
            const distributionChartRef = useRef(null);

            useEffect(() => {
                let filtered = creditData;
                if (statusFilter !== "Todos os Status") {
                    filtered = filtered.filter(credit => credit.status === statusFilter);
                }
                if (periodFilter !== "Últimos 30 dias") {
                    filtered = filtered.filter(credit => {
                        const startDate = new Date(credit.startDate.split("/").reverse().join("-"));
                        const now = new Date();
                        const daysDiff = (now - startDate) / (1000 * 60 * 60 * 24);
                        if (periodFilter === "Últimos 60 dias") return daysDiff <= 60;
                        if (periodFilter === "Últimos 90 dias") return daysDiff <= 90;
                        return true;
                    });
                }
                if (operationFilter !== "Todas as Operações") {
                    filtered = filtered.filter(credit => credit.type === operationFilter);
                }
                setFilteredCredits(filtered);
                setCurrentPage(1);
            }, [statusFilter, periodFilter, operationFilter]);

            useEffect(() => {
                if (performanceChartRef.current) performanceChartRef.current.destroy();
                if (distributionChartRef.current) distributionChartRef.current.destroy();

                const performanceCtx = document.getElementById('creditPerformanceChart').getContext('2d');
                performanceChartRef.current = new Chart(performanceCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                        datasets: [
                            {
                                label: 'Créditos Emitidos',
                                data: [2.5, 3.2, 3.5, 4.1, 4.8, 5.2, 6.1, 6.8, 7.5, 8.2, 9.1, 10.5],
                                borderColor: '#343E83',
                                backgroundColor: 'rgba(52, 62, 131, 0.1)',
                                tension: 0.4,
                                fill: true,
                            },
                            {
                                label: 'Pagamentos Recebidos',
                                data: [1.8, 2.3, 2.8, 3.2, 3.9, 4.5, 5.2, 5.8, 6.3, 7.1, 7.8, 8.5],
                                borderColor: '#32BECB',
                                backgroundColor: 'rgba(50, 190, 203, 0.1)',
                                tension: 0.4,
                                fill: true,
                            },
                        ],
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true, ticks: { callback: value => `R$ ${value}M` } } },
                        plugins: { tooltip: { callbacks: { label: context => `${context.dataset.label}: R$ ${context.raw}M` } } },
                    },
                });

                const distributionCtx = document.getElementById('creditDistributionChart').getContext('2d');
                distributionChartRef.current = new Chart(distributionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Imobiliário', 'Corporativo', 'Industrial', 'Agronegócio', 'Tecnologia'],
                        datasets: [{
                            data: [35, 25, 20, 15, 5],
                            backgroundColor: ['#343E83', '#32BECB', '#5DACCD', '#9E36EF', '#7A8FFF'],
                            borderWidth: 0,
                        }],
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'right' }, tooltip: { callbacks: { label: context => `${context.label}: ${context.raw}%` } } },
                    },
                });

                return () => {
                    if (performanceChartRef.current) performanceChartRef.current.destroy();
                    if (distributionChartRef.current) distributionChartRef.current.destroy();
                };
            }, []);

            const analyzeDocument = (file, creditId) => {
                // Simulação de análise de documento (pode ser expandida com OCR/NLP)
                const reader = new FileReader();
                reader.onload = (e) => {
                    const content = e.target.result.toLowerCase();
                    const alerts = [];
                    if (content.includes("inadimplência") || content.includes("atraso")) {
                        alerts.push("Risco de inadimplência detectado no documento");
                    }
                    if (content.includes("vencimento antecipado")) {
                        alerts.push("Cláusula de vencimento antecipado identificada");
                    }
                    if (content.includes("fraude") || content.includes("lavagem de dinheiro")) {
                        alerts.push("Padrão suspeito detectado: possível fraude ou lavagem de dinheiro");
                    }
                    setUploadedDocuments(prev => ({
                        ...prev,
                        [creditId]: [...(prev[creditId] || []), { name: file.name, content, alerts }],
                    }));
                    setFilteredCredits(prevCredits =>
                        prevCredits.map(credit =>
                            credit.id === creditId ? { ...credit, alerts: [...credit.alerts, ...alerts] } : credit
                        )
                    );
                };
                reader.readAsText(file);
            };

            const handleFileUpload = (e, creditId) => {
                const files = Array.from(e.target.files);
                files.forEach(file => analyzeDocument(file, creditId));
            };

            const generateDossier = (credit) => {
                return `
Dossiê de Crédito - ${credit.client} (${credit.id})
--------------------------------------------------
Cliente: ${credit.client}
CNPJ: ${credit.cnpj}
Tipo de Crédito: ${credit.type}
Valor Total: ${formatCurrency(credit.value)}
Taxa de Juros: ${credit.rate}% a.a.
Status: ${credit.status}
Rating Serasa: ${credit.serasaRating}
Score de Risco: ${credit.riskScore}/100
Progresso de Pagamento: ${credit.progress}%
Valor Pago: ${formatCurrency(credit.paidValue)}
Valor Restante: ${formatCurrency(credit.remainingValue)}
Data de Início: ${credit.startDate}
Data de Vencimento: ${credit.endDate}
Próximo Pagamento: ${credit.nextPaymentDate}
Valor da Parcela: ${formatCurrency(credit.installmentValue)}
Alertas: ${credit.alerts.join(", ") || "Nenhum alerta"}
Documentos Anexados: ${(uploadedDocuments[credit.id] || []).map(doc => doc.name).join(", ") || "Nenhum documento"}
Parecer Analítico: ${dossierNotes || "Insira seu parecer aqui."}
--------------------------------------------------
                `;
            };

            const indexOfLastCredit = currentPage * creditsPerPage;
            const indexOfFirstCredit = indexOfLastCredit - creditsPerPage;
            const currentCredits = filteredCredits.slice(indexOfFirstCredit, indexOfLastCredit);
            const totalPages = Math.ceil(filteredCredits.length / creditsPerPage);

            const formatCurrency = (value) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);

            return (
                <div className="min-h-screen bg-gray-50">
                    <main className="container mx-auto px-4 py-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold text-gray-800">Painel de Monitoramento de Crédito</h2>
                            <div className="flex space-x-2">
                                <button className="px-4 py-2 bg-[#343E83] text-white rounded-md hover:bg-opacity-90 transition flex items-center">
                                    <svg className="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 4v16m8-8H4" /></svg>
                                    Novo Crédito
                                </button>
                                <button className="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition flex items-center">
                                    <svg className="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                                    Exportar
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-lg transition-transform hover:-translate-y-1">
                                <div className="flex justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500 mb-1">Total de Créditos</p>
                                        <h3 className="text-2xl font-bold text-gray-800">R$ 12,5M</h3>
                                        <p className="text-xs text-green-500 mt-2 flex items-center">
                                            <svg className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 10l7-7m0 0l7 7m-7-7v18" /></svg>
                                            +8.2% desde o mês passado
                                        </p>
                                    </div>
                                    <div className="w-12 h-12 rounded-full bg-[#343E83] bg-opacity-10 flex items-center justify-center">
                                        <svg className="h-6 w-6 text-[#343E83]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-lg transition-transform hover:-translate-y-1">
                                <div className="flex justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500 mb-1">Taxa de Inadimplência</p>
                                        <h3 className="text-2xl font-bold text-gray-800">3.2%</h3>
                                        <p className="text-xs text-red-500 mt-2 flex items-center">
                                            <svg className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" /></svg>
                                            +0.5% desde o mês passado
                                        </p>
                                    </div>
                                    <div className="w-12 h-12 rounded-full bg-[#32BECB] bg-opacity-10 flex items-center justify-center">
                                        <svg className="h-6 w-6 text-[#32BECB]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-lg transition-transform hover:-translate-y-1">
                                <div className="flex justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500 mb-1">Créditos Ativos</p>
                                        <h3 className="text-2xl font-bold text-gray-800">247</h3>
                                        <p className="text-xs text-green-500 mt-2 flex items-center">
                                            <svg className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 10l7-7m0 0l7 7m-7-7v18" /></svg>
                                            +12 novos este mês
                                        </p>
                                    </div>
                                    <div className="w-12 h-12 rounded-full bg-[#5DACCD] bg-opacity-10 flex items-center justify-center">
                                        <svg className="h-6 w-6 text-[#5DACCD]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-lg transition-transform hover:-translate-y-1">
                                <div className="flex justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500 mb-1">Retorno Médio</p>
                                        <h3 className="text-2xl font-bold text-gray-800">14.7%</h3>
                                        <p className="text-xs text-green-500 mt-2 flex items-center">
                                            <svg className="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 10l7-7m0 0l7 7m-7-7v18" /></svg>
                                            +1.2% desde o mês passado
                                        </p>
                                    </div>
                                    <div className="w-12 h-12 rounded-full bg-[#9E36EF] bg-opacity-10 flex items-center justify-center">
                                        <svg className="h-6 w-6 text-[#9E36EF]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="font-semibold text-gray-800">Desempenho de Crédito</h3>
                                    <div className="flex space-x-2">
                                        <button className="px-3 py-1 text-sm bg-gray-100 rounded-md hover:bg-gray-200">Mensal</button>
                                        <button className="px-3 py-1 text-sm bg-[#343E83] text-white rounded-md">Anual</button>
                                    </div>
                                </div>
                                <div className="h-64">
                                    <canvas id="creditPerformanceChart"></canvas>
                                </div>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="font-semibold text-gray-800">Distribuição por Tipo de Crédito</h3>
                                    <button className="text-[#343E83] hover:text-[#2a326b]">
                                        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" /></svg>
                                    </button>
                                </div>
                                <div className="h-64">
                                    <canvas id="creditDistributionChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
                            <div className="p-6 border-b border-gray-100">
                                <div className="flex justify-between items-center">
                                    <h3 className="font-semibold text-gray-800">Créditos Recentes</h3>
                                    <div className="flex space-x-4">
                                        <select className="pl-3 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#343E83]" onChange={e => setStatusFilter(e.target.value)}>
                                            <option>Todos os Status</option>
                                            <option>Adimplente</option>
                                            <option>Inadimplente</option>
                                            <option>Em Atraso</option>
                                        </select>
                                        <select className="pl-3 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#343E83]" onChange={e => setPeriodFilter(e.target.value)}>
                                            <option>Últimos 30 dias</option>
                                            <option>Últimos 60 dias</option>
                                            <option>Últimos 90 dias</option>
                                        </select>
                                        <select className="pl-3 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#343E83]" onChange={e => setOperationFilter(e.target.value)}>
                                            <option>Todas as Operações</option>
                                            <option>Imobiliário</option>
                                            <option>Corporativo</option>
                                            <option>Industrial</option>
                                            <option>Agronegócio</option>
                                            <option>Tecnologia</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Taxa</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Progresso</th>
                                            <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {currentCredits.map(credit => (
                                            <tr key={credit.id} className="hover:bg-gray-50 transition">
                                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{credit.id}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{credit.client}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{credit.type}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{formatCurrency(credit.value)}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{credit.rate}%</td>
                                                <td className="px-6 py-4 whitespace-nowrap">
                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${credit.status === 'Adimplente' ? 'bg-green-100 text-green-800' : credit.status === 'Em Atraso' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}`}>
                                                        {credit.status}
                                                    </span>
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap">
                                                    <div className="progress-bar w-full">
                                                        <div className={`progress-fill ${credit.status === 'Adimplente' ? 'bg-green-500' : credit.status === 'Em Atraso' ? 'bg-yellow-500' : 'bg-red-500'}`} style={{ width: `${credit.progress}%` }}></div>
                                                    </div>
                                                    <div className="text-xs text-gray-500 mt-1">{credit.progress}% pago</div>
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                    <button className="text-[#343E83] hover:text-[#2a326b] mr-3" onClick={() => setSelectedCredit(credit)}>Detalhes</button>
                                                    <button className="text-gray-500 hover:text-gray-700">
                                                        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 25" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" /></svg>
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                            <div className="px-6 py-4 border-t border-gray-100 flex items-center justify-between">
                                <div className="text-sm text-gray-500">
                                    Mostrando <span className="font-medium">{indexOfFirstCredit + 1}</span> a <span className="font-medium">{Math.min(indexOfLastCredit, filteredCredits.length)}</span> de <span className="font-medium">{filteredCredits.length}</span> resultados
                                </div>
                                <div className="flex space-x-2">
                                    <button className="px-3 py-1 border border-gray-300 rounded-md text-sm text-gray-500 hover:bg-gray-50 disabled:opacity-50" disabled={currentPage === 1} onClick={() => setCurrentPage(currentPage - 1)}>Anterior</button>
                                    {[...Array(totalPages)].map((_, i) => (
                                        <button key={i} className={`px-3 py-1 border border-gray-300 rounded-md text-sm ${currentPage === i + 1 ? 'bg-[#343E83] text-white' : 'text-gray-500 hover:bg-gray-50'}`} onClick={() => setCurrentPage(i + 1)}>{i + 1}</button>
                                    ))}
                                    <button className="px-3 py-1 border border-gray-300 rounded-md text-sm text-gray-500 hover:bg-gray-50 disabled:opacity-50" disabled={currentPage === totalPages} onClick={() => setCurrentPage(currentPage + 1)}>Próximo</button>
                                </div>
                            </div>
                        </div>
                    </main>

                    <footer className="bg-white border-t border-gray-200 py-4">
                        <div className="container mx-auto px-4 text-center text-sm text-gray-500">
                            © 2025 SecuriCredit Monitor. Todos os direitos reservados.
                        </div>
                    </footer>

                    {selectedCredit && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onClick={() => setSelectedCredit(null)}>
                            <div className="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto" onClick={e => e.stopPropagation()}>
                                <div className="p-6 border-b border-gray-200 flex justify-between items-center">
                                    <h3 className="text-xl font-bold text-gray-800">Detalhes do Crédito {selectedCredit.id}</h3>
                                    <button className="text-gray-400 hover:text-gray-500" onClick={() => setSelectedCredit(null)}>
                                        <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                    </button>
                                </div>
                                <div className="p-6">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <h4 className="text-lg font-semibold mb-4">Informações do Crédito</h4>
                                            <div className="space-y-3">
                                                <div className="flex justify-between"><span className="text-gray-600">ID:</span><span className="font-medium">{selectedCredit.id}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Cliente:</span><span className="font-medium">{selectedCredit.client}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">CNPJ:</span><span className="font-medium">{selectedCredit.cnpj}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Tipo:</span><span className="font-medium">{selectedCredit.type}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Valor Total:</span><span className="font-medium">{formatCurrency(selectedCredit.value)}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Taxa de Juros:</span><span className="font-medium">{selectedCredit.rate}% a.a.</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Data de Início:</span><span className="font-medium">{selectedCredit.startDate}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Data de Vencimento:</span><span className="font-medium">{selectedCredit.endDate}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Rating Serasa:</span><span className="font-medium">{selectedCredit.serasaRating}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Score de Risco:</span><span className="font-medium">{selectedCredit.riskScore}/100</span></div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 className="text-lg font-semibold mb-4">Status de Pagamento</h4>
                                            <div className="mb-4">
                                                <div className="flex justify-between mb-1">
                                                    <span className="text-sm font-medium">Progresso de Pagamento</span>
                                                    <span className="text-sm font-medium text-green-600">{selectedCredit.progress}%</span>
                                                </div>
                                                <div className="progress-bar w-full">
                                                    <div className={`progress-fill ${selectedCredit.status === 'Adimplente' ? 'bg-green-500' : selectedCredit.status === 'Em Atraso' ? 'bg-yellow-500' : 'bg-red-500'}`} style={{ width: `${selectedCredit.progress}%` }}></div>
                                                </div>
                                            </div>
                                            <div className="space-y-3">
                                                <div className="flex justify-between"><span className="text-gray-600">Valor Pago:</span><span className="font-medium text-green-600">{formatCurrency(selectedCredit.paidValue)}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Valor Restante:</span><span className="font-medium">{formatCurrency(selectedCredit.remainingValue)}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Próximo Pagamento:</span><span className="font-medium">{selectedCredit.nextPaymentDate}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Valor da Parcela:</span><span className="font-medium">{formatCurrency(selectedCredit.installmentValue)}</span></div>
                                                <div className="flex justify-between"><span className="text-gray-600">Status:</span>
                                                    <span className={`px-2 inline-flex text-xs font-semibold rounded-full ${selectedCredit.status === 'Adimplente' ? 'bg-green-100 text-green-800' : selectedCredit.status === 'Em Atraso' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}`}>
                                                        {selectedCredit.status}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="mb-6">
                                        <h4 className="text-lg font-semibold mb-4">Alertas</h4>
                                        {selectedCredit.alerts.length > 0 ? (
                                            <ul className="space-y-2">
                                                {selectedCredit.alerts.map((alert, index) => (
                                                    <li key={index} className="text-sm text-red-600 flex items-center">
                                                        <svg className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                                        {alert}
                                                    </li>
                                                ))}
                                            </ul>
                                        ) : (
                                            <p className="text-sm text-gray-600">Nenhum alerta ativo.</p>
                                        )}
                                    </div>

                                    <div className="mb-6">
                                        <h4 className="text-lg font-semibold mb-4">Upload de Documentos</h4>
                                        <input
                                            type="file"
                                            multiple
                                            accept=".txt,.pdf,.doc,.docx"
                                            className="mb-4"
                                            onChange={(e) => handleFileUpload(e, selectedCredit.id)}
                                        />
                                        {(uploadedDocuments[selectedCredit.id] || []).length > 0 && (
                                            <div className="space-y-2">
                                                <h5 className="text-sm font-medium text-gray-700">Documentos Carregados:</h5>
                                                <ul className="space-y-1">
                                                    {(uploadedDocuments[selectedCredit.id] || []).map((doc, index) => (
                                                        <li key={index} className="text-sm text-gray-600 flex items-center">
                                                            <span>{doc.name}</span>
                                                            {doc.alerts.length > 0 && (
                                                                <span className="ml-2 text-red-600 text-xs">({doc.alerts.length} alertas)</span>
                                                            )}
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                        )}
                                    </div>

                                    <div className="mb-6">
                                        <h4 className="text-lg font-semibold mb-4">Histórico de Pagamentos</h4>
                                        <div className="overflow-x-auto">
                                            <table className="min-w-full divide-y divide-gray-200">
                                                <thead className="bg-gray-50">
                                                    <tr>
                                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Comprovante</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="bg-white divide-y divide-gray-200">
                                                    {(paymentHistory[selectedCredit.id] || []).map((payment, index) => (
                                                        <tr key={index}>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{payment.date}</td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{formatCurrency(payment.value)}</td>
                                                            <td className="px-6 py-4 whitespace-nowrap">
                                                                <span className="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">{payment.status}</span>
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-[#343E83] hover:text-[#2a326b] cursor-pointer">Ver comprovante</td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div className="mb-6">
                                        <h4 className="text-lg font-semibold mb-4">Dossiê de Crédito</h4>
                                        <textarea
                                            className="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#343E83]"
                                            rows="5"
                                            placeholder="Adicione seu parecer analítico aqui..."
                                            value={dossierNotes}
                                            onChange={(e) => setDossierNotes(e.target.value)}
                                        ></textarea>
                                        <button
                                            className="mt-3 px-4 py-2 bg-[#343E83] text-white rounded-md hover:bg-opacity-90"
                                            onClick={() => {
                                                const dossier = generateDossier(selectedCredit);
                                                const blob = new Blob([dossier], { type: 'text/plain' });
                                                const url = URL.createObjectURL(blob);
                                                const a = document.createElement('a');
                                                a.href = url;
                                                a.download = `Dossie_${selectedCredit.id}.txt`;
                                                a.click();
                                                URL.revokeObjectURL(url);
                                            }}
                                        >
                                            Gerar e Baixar Dossiê
                                        </button>
                                    </div>

                                    <div className="flex justify-end space-x-3">
                                        <button className="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50">Exportar Relatório</button>
                                        <button className="px-4 py-2 bg-[#343E83] text-white rounded-md hover:bg-opacity-90">Enviar Notificação</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<CreditDashboard />, document.getElementById('root'));
    </script>
</body>
</html>